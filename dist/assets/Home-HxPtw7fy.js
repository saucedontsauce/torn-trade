import{r as l,u as f,j as e,f as j}from"./react-CGOmruj2.js";import{C as y,d as b,u as w}from"./index-aDfJD7Cu.js";import{f as N,q as v,w as k,r as T}from"./firebase-BcXptfJc.js";function O({cat:s,name:o}){return e.jsxs("div",{className:"relative border border-gray-700 rounded-lg p-4 shadow hover:shadow-lg transition duration-200 bg-gray-800 text-gray-100",children:[e.jsx("h2",{className:"text-xl font-bold mb-2",children:o}),Object.keys(s).map(t=>e.jsxs("div",{className:"flex justify-between text-sm text-gray-300",children:[e.jsxs("span",{children:[e.jsx("img",{src:`https://www.torn.com/images/items/${t}/small.png`,className:"inline",alt:"img"}),s[t].name]}),e.jsxs("span",{children:[" $",s[t].rate==="definitive"?s[t].val:s[t].val*s[t].market_price]})]},t))]})}function S(s){const{items:o,categories:t}=l.useMemo(()=>{let a=[],c={};return s.items.items.map(r=>{c[r.id]=r,a.includes(r.type)||a.push(r.type)}),{items:c,categories:a}},[s.items]),d=f(),u=s.hash,[C,x]=l.useState(!0),[n,g]=l.useState({}),[m,h]=l.useState({});async function p(){const a=N(b,"users"),c=v(a,k("link","==",u)),r=await T(c),i={...r.docs[0].data()};r.docs[0].exists()&&r.docs[0].data().public==!0?(i.credits=0)?d("/man-dont-pay"):(g({owner:i.displayName,list:i.list,order:i.order,scheme:i.scheme}),x(!1)):d("/")}return l.useEffect(()=>{Object.keys(n).length===0?p():(h({}),(n.order||t).map(a=>{let c=Object.entries(n.list).filter(i=>o[i[0]].type===a),r={};c.forEach(i=>r[i[0]]={...i[1],...o[i[0]]}),Object.keys(r).length>0&&h({...m,[a]:r})}))},[n]),console.log(n),n?e.jsxs("div",{className:"p-6 max-w-5xl mx-auto bg-gray-900 min-h-screen text-gray-100",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:n?.scheme?.title?n.scheme.title:`${n.owner}'s Price List`}),e.jsx("div",{className:"grid gap-4 sm:grid-cols-2",children:Object.keys(m).length>0?Object.keys(m).map(a=>e.jsx(O,{name:a,cat:m[a]},a)):e.jsxs("div",{className:"col-span-full text-center py-12 text-gray-400",children:[e.jsx("p",{className:"text-lg",children:"No items to show."}),e.jsx("p",{className:"text-sm text-gray-500",children:"Try changing your filters or asking this seller to add more items."})]})})]}):e.jsx(y,{children:e.jsx("h1",{children:"loading prices"})})}function E(){const{hash:s}=j(),{items:o}=w(),[t,d]=l.useState(!1);return l.useEffect(()=>{s&&d(s.split("").splice(1,s.length).join(""))},[s]),t?e.jsx(S,{items:o,hash:t}):e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Welcome to [WIP]"}),e.jsx("p",{children:"This site displays Torn data fetched from Google Sheets, There is a login function where you can set a price list and omit any items you dont want."}),e.jsxs("p",{className:"p-4",children:["Currently Torn has ",o?o.count:e.jsx("span",{className:"inline-block h-4 w-12 bg-gray-300 rounded animate-pulse"})," item codes, although some of them are duds."]})]})}const q=Object.freeze(Object.defineProperty({__proto__:null,default:E},Symbol.toStringTag,{value:"Module"}));export{E as H,S as T,q as a};
